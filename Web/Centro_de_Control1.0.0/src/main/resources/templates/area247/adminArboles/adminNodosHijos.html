<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" >
<head lang="en">	
    <title th:text="'' + ${title}"></title>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
       
	<div th:replace="fragments/frameMaps :: header-contend"></div> 
</head>
	
	
	<style>
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }   
        .contenido {
            position: relative;           
            margin: auto;
            top: 10%;
            width: 70%;
        }	
	</style>
	    

<body >
   	<div th:replace="fragments/frameMaps :: header-degra"></div>
   	
   	<div th:replace="fragments/frameMaps :: sideBar-Left-App"></div> 

 	

	<section id="main-content" >

		<div id="mapa" style="height: 100%"></div>

		<div th:replace="fragments/frameMaps :: ribbon-List"></div>

		<div th:replace="fragments/frameMaps :: notification-List"></div>

		<div th:replace="fragments/enviarMensajePush :: mensajes-push-chat"></div>
		<div th:replace="fragments/enviarMensajePush :: modalNotificaHisto"></div>
		
		

		<div id="modalNodos" class="modal" th:style="'display: ' + ${despliegeModalNodos}">    
	        <div class="contenido" >	
	        	        
	            <button onclick="closeModalNodos()" class="btn btn-close">
                    <span class="glyphicon glyphicon-remove" style="float: right; color: #FFFFFF;"></span> 
                </button>
				
	            <h1 class="title">Configuración de Nodos</h1>
	        		        			        	
	        	<div class="contenido-form">
	        	     
                    <form id="editNodoForm" th:action="@{/createUpdateNodoArbol}" th:method="post" onsubmit="return realizarValidacionesEdicion()"  
                     style="width:100%; background-color: #E8E8E8; float: center; font-size: 1.1vw; display: block;" enctype="multipart/form-data">  	         							  			
                       
					    <div class="row margin-reset"> 
                            <ul class="nav nav-tabs">
                            
                                <li data-toggle="tooltip" title="Agregar nuevo Nodo">
	                                <a style="padding:0px">
	                                    <div id="showFormNewNodo" class="btn btn-action" th:if="${puedeAdicionar}">
	                                        <span class="glyphicon glyphicon-plus"></span>
	                                        <span class="btn-text"> Agregar</span>
	                                    </div>
	                                </a>
                                </li>
                                                                                               
                                <li data-toggle="tooltip" title="Guardar Cambios">
	                                <a style="padding:0px">
	                                    <button id="botonEdicion" class="btn btn-action" style=" display:none;" type="submit">
	                                        <span class="glyphicon glyphicon-floppy-disk"></span>
	                                        <span class="btn-text"> Guardar</span>
	                                    </button>
	                                </a>
                                </li> 	
                                
								<li data-toggle="tooltip" title="Deshacer">
								    <a id="botonDeshacerEdit" style="display:none;padding:0px">
								     	 <div class="btn btn-action">
										     <span class="glyphicon glyphicon glyphicon-repeat"></span>
										     <span class="btn-text">Deshacer</span>
								     	 </div>
								    </a>
								</li>                                 
                                																					
								<li data-toggle="tooltip" title="Regresar">
								    <a id="returnPadre" style="padding:0px;" th:href="@{''} + ${enlaceRetorno}">
										<div class="btn btn-action">
									         <span class="glyphicon glyphicon-arrow-left"></span>
									         <span class="btn-text"> Regresar</span>
										</div>
								     </a>
								</li> 
								
                            </ul>
					    </div>
					    
					    <br/>
						
						<div class="row margin-reset">  
						    <div class="col-xs-9 col-sm-9 col-md-9">
					            <div class="row margin-reset"> 
								    <div class="col-xs-2 col-sm-2 col-md-2">
									    <p style="color:#9FC418;">ID</p>
					                </div>
									<div class="col-xs-8 col-sm-8 col-md-8">
									    <p style="color:#9FC418;">Nombre</p>
					                </div>
					                <div class="col-xs-2 col-sm-2 col-md-2">
										<p style="color: #9FC418;">Orden <span class="	glyphicon glyphicon-sort-by-order"></span></p>
									</div>									
					            </div>
					            <div class="row margin-reset"> 
									<div class="col-xs-2 col-sm-2 col-md-2">
									     <input type="text" id="id" th:name="id" class="form-control" style="border-radius: 0px;" readonly="true"></input>
					                </div>
									<div class="col-xs-8 col-sm-8 col-md-8">
									    <input type="text" id="nombre" th:name="nombre" class="form-control editField" readonly="true" style="border-radius: 0px;"></input>
					                </div>
									<div class="col-xs-2 col-sm-2 col-md-2">
										<input type="number" id="orden" th:name="orden" min="0" max="100" class="form-control editField" readonly="true" style=" border-radius: 0px;"></input>
									</div>										
					            </div>
					            
					            <br/>								
					            <div class="row margin-reset"> 
					                <div class="col-xs-12 col-sm-12 col-md-12">
									    <p style="color:#9FC418;">Descripción <span class="glyphicon glyphicon-pencil"></span> </p>
					                </div> 									
					            </div>
					            <div class="row margin-reset">							  
									<div class="col-xs-12 col-sm-12 col-md-12">
									    <input type="text" id="descripcion" th:name="descripcion" class="form-control editField" readonly="true" style="border-radius: 0px;"></input>
					                </div>   									
					            </div>
					            
					            <br/>	
					            <div class="row margin-reset"> 
					                <div class="col-xs-7 col-sm-7 col-md-7">
									    <p style="color:#9FC418;">Alias</p>
					                </div> 
					                <div class="col-xs-5 col-sm-5 col-md-5">
									    <p id="autoridadCompetenteTexto" style="color:#9FC418;">Autoridad competente</p>
					                </div>								
					            </div>
					            <div class="row margin-reset">							  
									<div class="col-xs-7 col-sm-7 col-md-7">
									    <input type="text" id="alias" th:name="alias" class="form-control editField" readonly="true" style="border-radius: 0px;"></input>
					                </div>
					                <div class="col-xs-5 col-sm-5 col-md-5">
						                <label class="lbl-select">
											<select id="autoridadCompetente" th:name="autoridadCompetente" class="form-control editField" readonly="true">
											    <option value="0">Sin autoridad competente</option>
											    <option th:each="autoridadCompetente : ${autoridadCompetenteList}" th:value="${autoridadCompetente.id}" 
												 th:text="${autoridadCompetente.nombre}"></option>									
											</select>
						                </label>
									</div>									
					            </div>
					            
					            <br/>								
					            <div class="row margin-reset"> 
					                <div class="col-xs-6 col-sm-6 col-md-6">
									    <p style="color:#9FC418;">Instrucciones</p>
					                </div> 									
					                <div class="col-xs-6 col-sm-6 col-md-6">
									    <p style="color:#9FC418;">Instrucciones detalladas</p>
					                </div> 									
					            </div>					            							
					            <div class="row margin-reset">							  
									<div class="col-xs-6 col-sm-6 col-md-6">
									    <input type="text" id="instrucciones" th:name="instrucciones" 
									     class="form-control editField" readonly="true" style="border-radius: 0px;"></input>
					                </div>   																  
									<div class="col-xs-6 col-sm-6 col-md-6">
									    <input type="text" id="instruccionesDetalladas" th:name="instruccionesDetalladas" 
									     class="form-control editField" readonly="true" style="border-radius: 0px;"></input>
					                </div>   									
					            </div>
								
								<br/>								
					            <div class="row margin-reset"> 
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Mostrar hijos en dropdown</p>
					                </div>	
					                <div class="col-xs-2 col-sm-2 col-md-2">
						                <label class="lbl-select">
											<select id="flagHijosDropdown" th:name="flagHijosDropdown" class="form-control editField" readonly="true">
											    <option value="false">No</option>
												<option value="true">Si</option>											
											</select>
						                </label>
									</div>	
                                    <div class="col-xs-6 col-sm-6 col-md-6"></div>									
								</div>
								
								<div id="iconosVigia" class="row margin-reset" >
						    		<br/>	
                                    <p style="color:#9FC418; text-align: center;">Iconos de reportes de Vigía</p>
							        <div class="col-xs-3 col-sm-3 col-md-3"> 
									    <p style="color:#9FC418;">Icono Aprobado</p>
		                                   <div class="file-loading">
		                                       <input id="iconoVigiaApr" name="iconoVigiaApr" type="file" class="iconoUpload editOtherField" disabled="disabled" onchange="cargarIcono(this.id)"></input>                                            
		                                   </div> 								
								    </div>					    						    
							        <div class="col-xs-3 col-sm-3 col-md-3"> 
									    <p style="color:#9FC418;">Icono Pendiente</p>
		                                   <div class="file-loading">
		                                       <input id="iconoVigiaPen" name="iconoVigiaPen" type="file" class="iconoUpload editOtherField" disabled="disabled" onchange="cargarIcono(this.id)"></input>                                            
		                                   </div> 								
								    </div>
							        <div class="col-xs-3 col-sm-3 col-md-3"> 
									    <p style="color:#9FC418;">Icono Rechazado</p>
		                                   <div class="file-loading">
		                                       <input id="iconoVigiaRec" name="iconoVigiaRec" type="file" class="iconoUpload editOtherField" disabled="disabled" onchange="cargarIcono(this.id)"></input>                                            
		                                   </div> 								
								    </div>	
                                       <div class="col-xs-3 col-sm-3 col-md-3"> 
									    <p style="color:#9FC418;">Icono Ventana</p>
		                                   <div class="file-loading">
		                                       <input id="iconoVigiaWin" name="iconoVigiaWin" type="file" class="iconoUpload editOtherField" disabled="disabled" onchange="cargarIcono(this.id)"></input>                                            
		                                   </div> 								
								    </div>											
							    </div>
											            					   
                            </div>
							<div class="col-xs-3 col-sm-3 col-md-3" style="font-size: 0.8vw;" th:style="'display: ' + ${mostrarMultimedia} + ';'">
							    <div class="row margin-reset">
								    	<p style="color:#9FC418;">Formato Multimedia</p>
								</div>	
							    <div class="row margin-reset">	
								    <label class="lbl-select">
									    	<select id="formatoMedia" th:name="formatoMedia" class="form-control">
									    		<option value="Imagen">Imagen</option>
									    		<option value="Video">Video (mp4)</option>
	                                            <option value="Audio">Audio (mp3)</option>											
									    	</select>
								    </label>
								</div>									
								<br/>
							    <div class="row margin-reset"> 
								    <div id="multImagen" class="row margin-reset">
									    <p style="color:#9FC418;">Imagen</p>	
                                        <div class="file-loading">
                                            <input id="multimedia" name="multimedia" type="file" class="iconoUpload editOtherField" disabled="disabled" onchange="cargarIcono(this.id)"></input>
                                        </div> 	
					                </div>		
                                    <div id="multVideo" class="row margin-reset" style="display:none;">
									    <p style="color:#9FC418;">URL Multimedia</p>
									    <input type="text" id="urlMediaVideoAudio" th:name="urlMediaVideoAudio" class="form-control" style="border-radius: 0px;"></input>
					                </div>  									
							    </div>
													
								<!--<br/>
							    <div class="row margin-reset"> 
								    <div id="iconoVigia" class="row margin-reset">
									    <p style="color:#9FC418;">Icono marcador para reportes de Vigía</p>	
                                        <div class="file-loading">
                                            <input id="iconoMarcadorVigia" name="iconoMarcadorVigia" type="file" class="iconoUpload editOtherField" disabled="disabled" onchange="cargarIcono(this.id)"></input>
                                        </div> 	
					                </div> 									
							    </div>-->
                            </div>							
					    </div>					    				    	
					    <br/>
					    <p id="validacionEdicion" style="text-align:center; color: #FB0101"></p>					    
					    <p id="mensajeFormNodo" th:text="'' + ${mensajeFormularioNodo}" style="text-align:center"></p>
					    <input type="hidden" th:name="idPadre" th:value="'' + ${idPadre}"></input>
					    <input type="hidden" th:name="idArbol" th:value="'' + ${idArbol}"></input>	
					    <input type="hidden" th:name="rutaNodos" th:value="'' + ${rutaNodos}"></input>
						<input type="hidden" th:name="pedirMultimedia" th:value="'' + ${mostrarMultimedia}"></input>
					    <input type="hidden" id="ordenSelectOmitFromValidation" th:name="ordenSelectOmitFromValidation"></input>					    				
                    </form> 
					

                    <form id="createNodoForm" th:action="@{/createUpdateNodoArbol}" th:method="post" onsubmit="return realizarValidacionesCreacion()" 
                     style="width:100%; background-color: #E8E8E8; float: center; font-size: 1.1vw; display: none;" enctype="multipart/form-data">  	         							  			
                        
					    <div class="row margin-reset"> 
                            <ul class="nav nav-tabs">
                            
                                <li data-toggle="tooltip" title="Guardar nuevo Nodo">
	                                <a style="padding:0px">
	                                    <button id="addNewNodo" class="btn btn-action" type="submit">
	                                        <span class="glyphicon glyphicon-floppy-disk"></span>
	                                        <span class="btn-text"> Guardar</span>
	                                    </button>
	                                </a>
                                </li> 
                                
                                <li data-toggle="tooltip" title="Cancelar">
	                                <a style="padding:0px">
	                                    <button id="cancelNewNodo" class="btn btn-action">
	                                        <span class="glyphicon glyphicon-remove"></span>
	                                        <span class="btn-text"> Cancelar</span>
	                                    </button>
	                                </a>
                                </li>
                                
                                <li data-toggle="tooltip" title="Deshacer">
								    <a id="botonDeshacerNew" style="padding:0px">
								     	 <div class="btn btn-action">
										     <span class="glyphicon glyphicon glyphicon-repeat"></span>
										     <span class="btn-text">Deshacer</span>
								     	 </div>
								    </a>
								</li> 	                                
                                 
                            </ul> 						
					    </div>
					    
					    <br/>
						
						<div class="row margin-reset">  
						    <div class="col-xs-9 col-sm-9 col-md-9">
					            <div class="row margin-reset"> 
									<div class="col-xs-10 col-sm-10 col-md-10">
									    <p style="color:#9FC418;">Nombre</p>
					                </div>
					                <div class="col-xs-2 col-sm-2 col-md-2">
										<p style="color: #9FC418;">Orden <span class="glyphicon glyphicon-sort-by-order"></span></p>
									</div>										
					            </div>
					            <div class="row margin-reset">
									<div class="col-xs-10 col-sm-10 col-md-10">
									    <input type="text" id="nombreNew" th:name="nombre" class="form-control" style="border-radius: 0px;"></input>
					                </div>
									<div class="col-xs-2 col-sm-2 col-md-2">
										<input type="number" id="ordenNew" th:name="orden" min="0" max="100" class="form-control" style="border-radius: 0px;"></input>										
									</div>										
					            </div>
					            
					            <br/>	
					            <div class="row margin-reset"> 
					                <div class="col-xs-12 col-sm-12 col-md-12">
									    <p style="color:#9FC418;">Descripción <span class="glyphicon glyphicon-pencil"></span> </p>
					                </div> 									
					            </div>
					            <div class="row margin-reset">							  
									<div class="col-xs-12 col-sm-12 col-md-12">
									    <input type="text" id="descripcionNew" th:name="descripcion" class="form-control" style="border-radius: 0px;"></input>
					                </div>   									
					            </div>
					            
					            <br/>	
					            <div class="row margin-reset"> 
					                <div class="col-xs-7 col-sm-7 col-md-7">
									    <p style="color:#9FC418;">Alias</p>
					                </div>
					                <div class="col-xs-5 col-sm-5 col-md-5">
									    <p style="color:#9FC418;">Autoridad competente</p>
					                </div>								
					            </div>
					            <div class="row margin-reset">							  
									<div class="col-xs-7 col-sm-7 col-md-7">
									    <input type="text" id="aliasNew" th:name="alias" class="form-control" style="border-radius: 0px;"></input>
					                </div>
					                <div class="col-xs-5 col-sm-5 col-md-5">
							                <label class="lbl-select">
												<select id="autoridadCompetenteNew" th:name="autoridadCompetente" class="form-control">
												    <option value="0">Sin autoridad competente</option>
												    <option th:each="autoridadCompetente : ${autoridadCompetenteList}" th:value="${autoridadCompetente.id}" 
													 th:text="${autoridadCompetente.nombre}"></option>									
												</select>
							                </label>
										</div>									
					            </div>	
					            
					            <br/>								
					            <div class="row margin-reset"> 
					                <div class="col-xs-6 col-sm-6 col-md-6">
									    <p style="color:#9FC418;">Instrucciones</p>
					                </div> 									
					                <div class="col-xs-6 col-sm-6 col-md-6">
									    <p style="color:#9FC418;">Instrucciones detalladas</p>
					                </div> 									
					            </div>							
					            <div class="row margin-reset">							  
									<div class="col-xs-6 col-sm-6 col-md-6">
									    <input type="text" id="instruccionesNew" th:name="instrucciones" 
									     class="form-control" style="border-radius: 0px;"></input>
					                </div>   																  
									<div class="col-xs-6 col-sm-6 col-md-6">
									    <input type="text" id="instruccionesDetalladasNew" th:name="instruccionesDetalladas" 
									     class="form-control" style="border-radius: 0px;"></input>
					                </div>   									
					            </div>	

                                <br/>								
					            <div class="row margin-reset"> 
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Mostrar hijos en dropdown</p>
					                </div>	
					                <div class="col-xs-2 col-sm-2 col-md-2">
						                <label class="lbl-select">
											<select id="flagHijosDropdownNew" th:name="flagHijosDropdown" class="form-control">
											    <option value="false">No</option>
												<option value="true">Si</option>											
											</select>
						                </label>
									</div>	
                                    <div class="col-xs-6 col-sm-6 col-md-6"></div>									
								</div>	

								<div id="iconosVigiaNew" class="row margin-reset" >
						    		<br/>	
                                    <p style="color:#9FC418; text-align: center;">Iconos de reportes de Vigía</p>
							        <div class="col-xs-3 col-sm-3 col-md-3"> 
									    <p style="color:#9FC418;">Icono Aprobado</p>
		                                   <div class="file-loading">
		                                       <input id="iconoVigiaAprNew" name="iconoVigiaApr" type="file" class="iconoUpload"></input>                                            
		                                   </div> 								
								    </div>					    						    
							        <div class="col-xs-3 col-sm-3 col-md-3"> 
									    <p style="color:#9FC418;">Icono Pendiente</p>
		                                   <div class="file-loading">
		                                       <input id="iconoVigiaPenNew" name="iconoVigiaPen" type="file" class="iconoUpload"></input>                                            
		                                   </div> 								
								    </div>
							        <div class="col-xs-3 col-sm-3 col-md-3"> 
									    <p style="color:#9FC418;">Icono Rechazado</p>
		                                   <div class="file-loading">
		                                       <input id="iconoVigiaRecNew" name="iconoVigiaRec" type="file" class="iconoUpload"></input>                                            
		                                   </div> 								
								    </div>	
                                       <div class="col-xs-3 col-sm-3 col-md-3"> 
									    <p style="color:#9FC418;">Icono Ventana</p>
		                                   <div class="file-loading">
		                                       <input id="iconoVigiaWinNew" name="iconoVigiaWin" type="file" class="iconoUpload"></input>                                            
		                                   </div> 								
								    </div>											
							    </div>							
					   
                            </div>
							<div class="col-xs-3 col-sm-3 col-md-3" style="font-size: 0.8vw;" th:style="'display: ' + ${mostrarMultimedia} + ';'">
							    <div class="row margin-reset">
								    	<p style="color:#9FC418;">Formato Multimedia</p>
								    	<label class="lbl-select">
									    	<select id="formatoMediaNew" th:name="formatoMedia" class="form-control">
									    		<option value="Imagen">Imagen</option>
									    		<option value="Video">Video (mp4)</option>
	                                            <option value="Audio">Audio (mp3)</option>											
									    	</select>
								    	</label>
								</div>									
								<br/>
							    <div class="row margin-reset"> 
								    <div id="multImagenNew" class="row margin-reset">
									    <p style="color:#9FC418;">Imagen</p>
                                        <div class="file-loading">
                                            <input id="multimediaNew" name="multimedia" type="file" class="iconoUpload"></input>
                                        </div> 	
					                </div>		
                                    <div id="multVideoNew" class="row margin-reset" style="display:none;">
									    <p style="color:#9FC418;">URL Multimedia</p>
									    <input type="text" id="urlMediaVideoAudioNew" th:name="urlMediaVideoAudio" class="form-control" style="border-radius: 0px;"></input>
					                </div>  									
							    </div>

								<!--<br/>
							    <div class="row margin-reset"> 
								    <div id="iconoVigiaNew" class="row margin-reset">
									    <p style="color:#9FC418;">Icono marcador para reportes de Vigía</p>
                                        <div class="file-loading">
                                            <input id="iconoMarcadorVigiaNew" name="iconoMarcadorVigia" type="file" class="iconoUpload"></input>
                                        </div> 	 	
					                </div> 									
							    </div>-->									
								
                            </div>							
							
					    </div>
					    <br/>	
					    <p id="validacionCreacion" style="text-align:center; color: #FB0101"></p>
					    <input type="hidden" th:name="idPadre" th:value="'' + ${idPadre}"></input>	
						<input type="hidden" th:name="idArbol" th:value="'' + ${idArbol}"></input>	
					    <input type="hidden" th:name="rutaNodos" th:value="'' + ${rutaNodos}"></input>
					    <input type="hidden" th:name="pedirMultimedia" th:value="'' + ${mostrarMultimedia}"></input>				    					    					    				
                    </form>
                    
                    <h4 id="rutaMostrada" style="color:#FFFFFF;" th:text="${rutaMostrada}"></h4> 
					
                    <br/>
                          
                    <h2 style="text-align:left; color: #FFFFFF;">Nodos</h2>
      	        	
      	        	<div style="overflow-x:auto;">   
               	    <table id="tableNodos" class="table table-striped table-bordered" cellspacing="0" 
               	           style="width: 100%; background-color: #E8E8E8; font-size: 0.9vw;">
               	        <thead>
               	            <tr>                                   
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Alias</th>
                                <th>Orden</th>  
                                <th th:style="'display: ' + ${mostrarMultimedia} + '; height: auto'">Multimedia</th>
                                <th>Icono reporte</th>
                                <th>Nodos hijos</th>                                
                                <th>Hijos</th>   
                                <th>Eliminar</th>                               
                                <th>Editar</th>                                          
                            </tr>
                        </thead>
                          
                        <tbody>                   
                            <tr th:each="nodo : ${nodoList}">
                                <td th:text="${nodo.id}"></td>
                                <td th:text="${nodo.nombre}"></td>
                                <td th:text="${nodo.alias}"></td>   
                                <td th:text="${nodo.orden}"></td>                                                              
                                <td th:style="'display: ' + ${mostrarMultimedia} + ';'">								
								    <div th:if="${nodo.formatoMedia} == 'Imagen'">
									    <img th:src="${nodo.urlMediaImagen}" style="width: 60px;" />
								    </div>	
								    <div th:if="${nodo.formatoMedia} == 'Video'">
									    <span style="font-size: 40px; color: #9FC418;" class="glyphicon glyphicon-film"></span>
								    </div>
								    <div th:if="${nodo.formatoMedia} == 'Audio'">
									    <span style="font-size: 50px; color: #9FC418;" class="glyphicon glyphicon-volume-up"></span>
								    </div>							
								</td> 
								<td align="center">                               
                                    <img th:if="${!nodo.tieneHijos}" th:src="${nodo.urIconoVigiaPen}" th:style="'width: 60px; top: -9px;'"/>								    								    
                                </td>  
                                <td>
                                    <a class="btn btn-default" style="height:32px; background-color: #9FC418; 
                                     border: 1px solid; border-color: #D0D0D0; border-radius: 3px; font-size: 0.9vw;"
									 th:href="'/obtenerNodosByPadre/' + ${rutaNodos} + '/' + ${idArbol} + '/' + ${nodo.id}">   
								        <span style="color: #FFFFFF;">Nodos hijos</span>
								    </a>							    
								</td>  								                                 
                                <td>
                                    <span th:if="${!nodo.tieneHijos}">No</span> 
								    <span th:if="${nodo.tieneHijos}">Si</span>
								</td> 

								
								
								<td>
									<a th:id="${nodo.id}" class="btn btn-default deleteButton" th:if="${puedeBorrar} AND ${!nodo.tieneHijos}" 
									 style="height:32px; background-color: #FB0101; border: 1px solid; border-color: #D0D0D0; border-radius: 3px;">
								        <span style="color: #FFFFFF;" class="glyphicon glyphicon-trash"></span> 
								    </a>
								</td>                                                                                   
                                <td>
                                    <button th:id="${nodo.id}" style="background-color: #9FC418;" 
                                     th:if="${puedeEditar}" class="btn btn-default editButtonNodo">
									    <span style="color: #FFFFFF;" class="glyphicon glyphicon-pencil"></span>
									</button>
                                </td>                                    
                            </tr>                                                                                                     
                        </tbody>
                    </table> 
                    </div>  
						
                </div>
               
            </div>       
        </div>  
                                   				
    </section>

    <div th:replace="fragments/printMap :: printMap"></div>
	
    <script th:inline="javascript">

        $(document).ready(function() {
            $('#tableNodos').dataTable({
                "language": {"url": "/assets/json/spanishTable.json"},
                "order": [[ 3, "asc" ]],
                "columnDefs": [
				    { "orderable": false, "targets": [5,6,8,9], "width" : "1vw" },
				    { "targets": [0,3,7], "width" : "1vw" }
				  ]
            });
        });    
        
        function openModalNodos() {
            document.getElementById('modalNodos').style.display = "block";
        }  
    
        function closeModalNodos() {
            document.getElementById('modalNodos').style.display = "none";
        }
        
        $('.editButtonNodo').on('click', function() {
            var id = $(this).attr('id');
            llenarFormularioEdicionNodos(id);
        });
            
        function llenarFormularioEdicionNodos(id) {           
            $.ajax({
                url: "/getNodo/" + id,
                method: "GET",
            }).success(function(response) {
            	$('#validacionEdicion').text("  ");   
            	$('#validacionCreacion').text("  ");            	
            	$('#mensajeFormNodo').text("  ");
				
				if(response.formatoMedia=="Imagen" || response.formatoMedia=="Sin multimedia"){
                    $('#multImagen').show(); 
                    $('#multVideo').hide(); 
					response.formatoMedia = "Imagen";
		    	}else{
		    	    $('#multImagen').hide(); 
                    $('#multVideo').show();
		    	}
            	
                $('#editNodoForm')
                    .find('[name="id"]').val(response.id).end()
                    .find('[name="nombre"]').val(response.nombre).end()
                    .find('[name="descripcion"]').val(response.descripcion).end()
                    .find('[name="alias"]').val(response.alias).end()
                    .find('[name="instrucciones"]').val(response.instrucciones).end()
                    .find('[name="instruccionesDetalladas"]').val(response.instruccionesDetalladas).end()
                    .find('[name="orden"]').val(""+response.orden).end()
					.find('[name="flagHijosDropdown"]').val(""+response.flagHijosDropdown).end()
					.find('[name="formatoMedia"]').val(response.formatoMedia).end()
					.find('[name="urlMediaVideoAudio"]').val(response.urlMediaVideoAudio).end()
					.find('[name="autoridadCompetente"]').val(""+response.idAutoridadCompetente).end()
                    .find('[name="ordenSelectOmitFromValidation"]').val(""+response.orden).end(); 

                $('.editField').attr("readonly",false);
                $('#botonEdicion').css("display","block");
                $('#botonDeshacerEdit').css("display","block");
                $('.editOtherField').attr("disabled",false);
                $('.iconoUploadStyle').css("cursor","pointer");
                
               	visualizarImagen("multimedia",response.urlMediaImagen);

               	visualizarImagen("iconoVigiaPen",response.urIconoVigiaPen);
                visualizarImagen("iconoVigiaApr",response.urIconoVigiaApr);
                visualizarImagen("iconoVigiaRec",response.urIconoVigiaRec);
                visualizarImagen("iconoVigiaWin",response.urIconoVigiaWin);
                               
                if (response.tieneHijos){
                	document.getElementById('autoridadCompetenteTexto').style.display = "none";
                	document.getElementById('autoridadCompetente').style.display = "none";
                	document.getElementById('iconosVigia').style.display = "none";                	
                }else{
                	document.getElementById('autoridadCompetenteTexto').style.display = "block";
                	document.getElementById('autoridadCompetente').style.display = "block";
                	document.getElementById('iconosVigia').style.display = "block";  
                }
            });                               
        };  
    
        $('#showFormNewNodo').on('click', function() {
        	document.getElementById("editNodoForm").reset();
            $('#editNodoForm').hide(); 
            $('#createNodoForm').show(); 
            $('#validacionCreacion').text("  ");
            $('#mensajeFormNodo').text("  ");
        }); 
    
        $('#cancelNewNodo').on('click', function() {
            $('#editNodoForm').show(); 
            document.getElementById("createNodoForm").reset();
            $('.editField').attr("readonly",true);
            $('#botonEdicion').css("display","none");
            $('#botonDeshacerEdit').css("display","none");
            $('#createNodoForm').hide(); 
            $('#validacionEdicion').text("  ");
            $('#mensajeFormNodo').text("  ");
        });  
		
		$('#formatoMedia').change(function() {
            var formato = $(this).attr('value');
			if(formato=="Imagen"){
                $('#multImagen').show(); 
                $('#multVideo').hide(); 
			}else{
			    $('#multImagen').hide(); 
                $('#multVideo').show();
			}
        });
        
        $('#formatoMediaNew').change(function() {
            var formato = $(this).attr('value');
			if(formato=="Imagen"){
                $('#multImagenNew').show(); 
                $('#multVideoNew').hide(); 
			}else{
			    $('#multImagenNew').hide(); 
                $('#multVideoNew').show();
			}
        });
        
        $('#botonDeshacerEdit').on('click', function() {
        	var id = $("#id").val(); 
			llenarFormularioEdicionNodos(id); 
        });

        $('#botonDeshacerNew').on('click', function() {
            document.getElementById("createNodoForm").reset();
            $('#validacionCreacion').text("  ");
        });
       
        $(document).on('ready', function() {
            $(".iconoUpload").fileinput({
                browseClass: "btn-sm btn-block iconoUploadStyle",
                showCaption: false,
                showRemove: false,
                showUpload: false,
                allowedFileExtensions: ["jpg","png","svg"],
                browseLabel: 'Seleccionar'
            });
        }); 	     		  
    </script> 
    
    
    <script th:inline="javascript">
        $('.deleteButton').on('click', function() {
        	var id = $(this).attr('id'); 
        	var linkDelete = "/deleteNodo/"  + [[${rutaNodos}]] + "/"   + [[${idArbol}]] + "/" + [[${idPadre}]] + "/" + id
        	$('#confirmDelete').attr("href",linkDelete);        	
        	$('#modalConfirmDelete').show();        	
        	$('#modalConfirmDelete').find('#cancelDelete').on('click', function() {
                $('#modalConfirmDelete').hide();
            });        	
        	$('#modalConfirmDelete').find('#confirmDelete').on('click', function() {
                $('#modalConfirmDelete').hide();
            });
        });  
    </script>
    
    <div th:replace="fragments/dialog :: modalConfirmDelete"></div> 
  
  
    
    
    <script type="text/javascript" th:inline="javascript" >	
        /*<![CDATA[*/ 
        function realizarValidacionesEdicion(){         	
        	var nombre = $("#nombre").val();  
            if(nombre != null){ 	
        	    if(nombre == ""){ 
        	    	document.getElementById('validacionEdicion').innerHTML = "El Nombre está vacío";
                    return false;
        	    }else{
        	    	if(nombre.length > 100){
                		document.getElementById('validacionEdicion').innerHTML = "El nombre no puede tener más de 100 caracteres";
                        return false;
                	}
        	    }
        	}              
            var descripcion = $("#descripcion").val();  
            if(descripcion != null){ 	
        	    if(descripcion == ""){ 
        	    	document.getElementById('validacionEdicion').innerHTML = "La Descripción está vacía";
                    return false;
        	    }else{
        	    	if(descripcion.length > 255){
                	    document.getElementById('validacionEdicion').innerHTML = "La descripción no puede tener más de 255 caracteres";
                        return false;
                	}
        	    }
        	}
            var alias = $("#alias").val();  
            if(alias != null){ 	
        	    if(alias.length > 100){
                	document.getElementById('validacionEdicion').innerHTML = "El nombre alias no puede tener más de 100 caracteres";
                       return false;
                }
        	}            
            var instrucciones = $("#instrucciones").val();  
            if(instrucciones != null){ 	
        	    if(instrucciones.length > 100){
                	document.getElementById('validacionEdicion').innerHTML = "Las instrucciones no pueden tener más de 100 caracteres";
                       return false;
                }
        	} 
            var instruccionesDetalladas = $("#instruccionesDetalladas").val();  
            if(instruccionesDetalladas != null){ 	
        	    if(instruccionesDetalladas.length > 100){
                	document.getElementById('validacionEdicion').innerHTML = "Las instrucciones detalladas no pueden tener más de 100 caracteres";
                       return false;
                }
        	}                        
            var orden = $("#orden").val(); 
            var ordenSelectOmitFromValidation = $("#ordenSelectOmitFromValidation").val(); 
            if(orden != null){
                if(orden == ""){ 
                	document.getElementById('validacionEdicion').innerHTML = "El Orden está vacío";
                    return false;
                }else{
                	if(isNaN(orden)){   
                		document.getElementById('validacionEdicion').innerHTML = "Valor incorrecto para Orden";
                	    return false;  
                	}else{
                		var ordenesList = [[${ordenesList}]];
                		for(i = 0; i < ordenesList.length; i++){
                			if(ordenesList[i]!=ordenSelectOmitFromValidation){
                			    if(ordenesList[i]==orden){
                				    document.getElementById('validacionEdicion').innerHTML = "Este Orden ya está en uso";
                        	        return false; 	
                			    }
                			}
                		}
                	} 
                } 
            }	
        };
               
        function realizarValidacionesCreacion(){        	
        	var nombre = $("#nombreNew").val();        	       	
        	if(nombre != null){ 	
        	    if(nombre == ""){ 
        	    	document.getElementById('validacionCreacion').innerHTML = "El Nombre está vacío";
                    return false;
        	    }else{
        	    	if(nombre.length > 100){
                	    document.getElementById('validacionCreacion').innerHTML = "El nombre no puede tener más de 100 caracteres";
                        return false;
                	}
        	    }
        	}        	
        	var descripcion = $("#descripcionNew").val();  
            if(descripcion != null){ 	
        	    if(descripcion == ""){ 
        	        document.getElementById('validacionCreacion').innerHTML = "La Descripción está vacía";
                    return false;
        	    }else{
        	    	if(descripcion.length > 255){
                        document.getElementById('validacionCreacion').innerHTML = "La descripción no puede tener más de 255 caracteres";
                        return false;
                	}
        	    }
        	}
            var alias = $("#aliasNew").val();  
            if(alias != null){ 	
        	    if(alias.length > 100){
                	document.getElementById('validacionCreacion').innerHTML = "El alias no puede tener más de 100 caracteres";
                       return false;
                }
        	}
            var instrucciones = $("#instruccionesNew").val();  
            if(instrucciones != null){ 	
        	    if(instrucciones.length > 100){
                	document.getElementById('validacionCreacion').innerHTML = "Las instrucciones no pueden tener más de 100 caracteres";
                       return false;
                }
        	} 
            var instruccionesDetalladas = $("#instruccionesDetalladasNew").val();  
            if(instruccionesDetalladas != null){ 	
        	    if(instruccionesDetalladas.length > 100){
                	document.getElementById('validacionCreacion').innerHTML = "Las instrucciones detalladas no pueden tener más de 100 caracteres";
                       return false;
                }
        	}              
            var orden = $("#ordenNew").val(); 
            if(orden != null){
                if(orden == ""){ 
                	document.getElementById('validacionCreacion').innerHTML = "El Orden está vacío";
                    return false;
                }else{
                	if(isNaN(orden)){   
                		document.getElementById('validacionCreacion').innerHTML = "Valor incorrecto para Orden";
                	    return false;  
                	}else{        		
                		var ordenesList = [[${ordenesList}]];
                		for(i = 0; i < ordenesList.length; i++){
                			if(ordenesList[i]==orden){
                				document.getElementById('validacionCreacion').innerHTML = "Este Orden ya está en uso";
                        	    return false; 	
                			}        			
                		}
                	}  
                } 
            }
        };	
        /*]]>*/
	</script>
                       	  
</body>
    
</html>
