<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" >
<head lang="en">	
    <title th:text="'' + ${title}"></title>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
       
	<div th:replace="fragments/frameMaps :: header-contend"></div> 
</head>
	
	
	<style>
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }   
        .contenido {
            position: relative;           
            margin: auto;
            top: 10%;
            width: 70%;
        }	
	</style>
	    

<body >
   	<div th:replace="fragments/frameMaps :: header-degra"></div> 
   	
   	<div th:replace="fragments/frameMaps :: sideBar-Left-App"></div> 

 	

	<section id="main-content" >

		<div id="mapa" style="height: 100%"></div>

		<div th:replace="fragments/frameMaps :: ribbon-List"></div>

		<div th:replace="fragments/frameMaps :: notification-List"></div>

		<div th:replace="fragments/enviarMensajePush :: mensajes-push-chat"></div>
		<div th:replace="fragments/enviarMensajePush :: modalNotificaHisto"></div>
		
		

		<div id="modalCategorias" class="modal" th:style="'display: ' + ${despliegeModalCateg}">    
	        <div class="contenido">	
	        	
	            <button onclick="closeModalCategorias()" class="btn btn-close">
                    <span class="glyphicon glyphicon-remove" style="float: right; color: #FFFFFF;"></span> 
                </button>
				
	            <h1 class="title">Configuración de Categorías</h1>
	        	
	        	<div class="contenido-form">
	        	    
                    <form id="editCategoriaForm" th:action="@{/createUpdateCategoria}" th:method="post" onsubmit="return realizarValidacionesEdicion()" 
                     style="width:100%; background-color: #E8E8E8; float: center; font-size: 1.1vw; display: block;" enctype="multipart/form-data">  	         							  			
                       
					    <div class="row margin-reset"> 
                            <ul class="nav nav-tabs">
                                <li data-toggle="tooltip" title="Agregar nueva categoría">
									<a style="padding:0px">
	                                    <button id="showFormNewCategoria" class="btn btn-action" th:if="${puedeAdicionar}">
	                                        <span class="glyphicon glyphicon-plus"></span>
	                                        <span class="btn-text"> Agregar</span>
	                                    </button>	
	                                </a>
                                </li>                                                         
                                <li data-toggle="tooltip" title="Guardar Cambios">
                                	<a style="padding:0px">
	                                    <button id="botonEdicion" class="btn btn-action" style="display:none;" type="submit">
	                                        <span class="glyphicon glyphicon-floppy-disk"></span>
	                                        <span class="btn-text"> Guardar</span>
	                                    </button>
                                    </a>
                                </li> 	
                                
								<li data-toggle="tooltip" title="Deshacer">
								    <a id="botonDeshacerEdit" style="display:none;padding:0px">
								     	 <div class="btn btn-action">
										     <span class="glyphicon glyphicon glyphicon-repeat"></span>
										     <span class="btn-text">Deshacer</span>
								     	 </div>
								    </a>
								</li>                                 
                                																					
								<li data-toggle="tooltip" title="Retornar a Capas">
								    <a id="returnCapas" style="padding:0px" th:href="'/getCapasByIdAplicacion/' + ${idAplicacionDeCapa}">
										<div class="btn btn-action">
									         <span class="glyphicon glyphicon-arrow-left"></span>
									         <span class="btn-text"> Retornar</span>
										</div>
									</a>
								</li> 
																
                            </ul> 						
					    </div>
					    
					    <br/>
						
						<div class="row margin-reset">  
						    <div class="col-xs-9 col-sm-9 col-md-9">
					   
					            <div class="row margin-reset"> 
								    <div class="col-xs-1 col-sm-1 col-md-2">
									    <p style="color:#9FC418;">ID</p>
					                </div>
									<div class="col-xs-2 col-sm-2 col-md-7">
									    <p style="color:#9FC418;">Nombre</p>
					                </div>				                					                															                					                
									<div class="col-xs-2 col-sm-2 col-md-3">
									    <p style="color: #9FC418;">Tipo</p>
								    </div>
					            </div>
					            <div class="row margin-reset">
									<div class="col-xs-2 col-sm-2 col-md-2">
									     <input type="text" id="id" name="id" class="form-control" style="border-radius: 0px;" 
									      readonly="true"></input>
					                </div>
									<div class="col-xs-7 col-sm-7 col-md-7">
									    <input type="text" id="nombre" name="nombre" style="border-radius: 0px;" 
									     class="form-control editField" readonly="true"></input>
					                </div>	
								    <div class="col-xs-4 col-sm-4 col-md-3">	
									    <label class="lbl-select">
										    <select id="tipo" th:name="tipo" class="form-control">
	                                            <option th:each="tipo : ${tipoCapaList}" th:value="${tipo.id}" th:text="${tipo.nombre}"></option>
	                                        </select>										
									    </label>								
								    </div>
					            </div>
					            <br/>
								<div class="row margin-reset"> 
									<div th:class="((${avistamiento} == 'block') ? 'col-xs-9 col-sm-9 col-md-9' : ((${ordenamiento} == 'block') ? 'col-xs-7 col-sm-7 col-md-7' : 'col-xs-12 col-sm-12 col-md-12')) + ';'">
									    <p style="color:#9FC418;">Descripción <span class="glyphicon glyphicon-pencil"></span> </p>
					                </div>
					                <div th:style="'display: ' + ${avistamiento} + ';'"> 
	                                    <div class="col-xs-2 col-sm-2 col-md-3">
										    <p style="color:#9FC418;">Tiene Historia</p>									
						                </div>	
					                </div>
					            </div>	
					            <div class="row margin-reset">							  
									<div th:class="((${avistamiento} == 'block') ? 'col-xs-9 col-sm-9 col-md-9' : ((${ordenamiento} == 'block') ? 'col-xs-12 col-sm-12 col-md-12' : 'col-xs-12 col-sm-12 col-md-12')) + ';'">
									    <input type="text" id="descripcion" name="descripcion" style="border-radius: 0px;"
									     class="form-control editField" readonly="true"></input>
					                </div>
					                <div th:style="'display: ' + ${avistamiento} + ';'">
									    <div class="col-xs-2 col-sm-2 col-md-3">	
										    <label class="lbl-select">
										        <select id="tieneHistoria" name="tieneHistoria"  class="form-control">
										            <option value="false">No</option>
	                                                <option value="true">Si</option>                                            
	                                            </select> 
										    </label>						
					                    </div>
					                </div>
					            </div>
					            <div class="row margin-reset">
					            	<div th:style="'display: ' + ${despliegueUrl} + ';'">
								        <br/>
									    <div class="col-xs-9 col-sm-9 col-md-9">
									        <p style="color:#9FC418;">URL Recurso</p>
					                    </div>
                                    </div>						            
					            </div>
                                <div class="row margin-reset"> 
								    <div th:style="'display: ' + ${despliegueUrl} + ';'">							  
									    <div class="col-xs-12 col-sm-12 col-md-12" id="div-urlRecurso">
									        <input type="text" id="urlRecurso" name="urlRecurso" style="border-radius: 0px;"
									         class="form-control editField" readonly="true"></input>
					                    </div>
                                    </div>										
					                <div class="col-xs-3 col-sm-3 col-md-3">					                
					                    <div id="programButtons" style="display:none;">     
                                            <a class="btn btn-default programTaskCateg" style="height:32px; background-color: #00BFFF; 
                                               border: 1px solid; border-color: #D0D0D0; border-radius: 3px;"
                                               data-toggle="tooltip" title="Programar tarea"> 								     
								                <span style="color: #FFFFFF;" class="glyphicon glyphicon-dashboard"></span>
								            </a>								            
									        <a id="runTaskButton" class="btn btn-default" style="height:32px; 
									           background-color: #9FC418; border: 1px solid; border-color: #D0D0D0; 
									           border-radius: 3px;" data-toggle="tooltip" title="Correr manualmente"> 								     
								                <span style="color: #FFFFFF;" class="glyphicon glyphicon-play"></span>
								            </a>											        								        									        
									    </div>  
									    <div id="stopTaskButtons" style="display:none;">  								            
								            <a id="stopTaskButton" class="btn btn-default stopTask" style="height:32px; background-color: #FB0101; 
                                               border: 1px solid; border-color: #D0D0D0; border-radius: 3px;"
                                               data-toggle="tooltip" title="Detener tarea"> 								     
								                <span style="color: #FFFFFF;" class="glyphicon glyphicon-pause"></span>
								            </a>											        								        									        
									    </div>   
					                </div>									
					            </div>	
					            <div class="row margin-reset">
					                <div th:style="'display: ' + ${ordenamiento} + ';'">
							            <br/>
									    <div class="col-xs-2 col-sm-2 col-md-4">
									        <p style="color:#9FC418;">Polígono</p>									
					                    </div>	
	                                   	<div class="col-xs-2 col-sm-2 col-md-4">
	                                   		<p style="color:#9FC418;">Ficha Caracterizacion</p>
	                                   	</div>
	                                    <div class="col-xs-2 col-sm-2 col-md-4">
						        			<p style="color:#9FC418;">Respuesta Ficha</p>
		                    			</div>	
					                </div>
					            </div>
					            <div class="row margin-reset">
									<div th:style="'display: ' + ${ordenamiento} + ';'">	
									    <div class="col-xs-1 col-sm-1 col-md-4">	
										    <label class="lbl-select">
										        <select id="poligono" name="poligono" class="form-control">
	                                                <option value="false">No</option>
	                                                <option value="true">Si</option>                                            
	                                            </select> 
										    </label>						
					                    </div>
									    <div class="col-xs-1 col-sm-1 col-md-4">	
										    <label class="lbl-select">
										        <select id="fichaCaracterizacion" name="fichaCaracterizacion" 
										         class="form-control" disabled="true">
										            <option value="false">No</option>
	                                                <option value="true">Si</option>                                           
	                                            </select> 
										    </label>						
					                    </div>	
									    <div class="col-xs-4 col-sm-4 col-md-4">
										    <label class="lbl-select">
										        <select id="respuestaFichaCarac" name="respuestaFichaCarac" 
										         class="form-control" disabled="true">
	                                                <option value=""></option>
	                                                <option value="SI/NO">SI/NO</option>                                            
	                                                <option value="NOMBRE">NOMBRE</option>
	                                                <option value="NOMBRE-DESCRIPCION">NOMBRE-DESCRIPCION</option>
	                                            </select> 
										    </label>
					                    </div>	
					                </div>
					            </div>							
                               
					            <div class="row margin-reset" th:style="'display: ' + ${ordenamiento} + ';'">
								    <br/>
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Alias Nombre</p>
					                </div>								  
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Alias Municipio</p>
					                </div>								  
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Alias Descripción</p>
					                </div>								  
					            
					            </div>
					            
                                <div class="row margin-reset" th:style="'display: ' + ${ordenamiento} + ';'"> 
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <input type="text" id="aliasNombre" name="aliasNombre" style="border-radius: 0px;"
									     class="form-control editField" readonly="true"></input>
					                </div>	
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <input type="text" id="aliasMunicipio" name="aliasMunicipio" style="border-radius: 0px;"
									     class="form-control editField" readonly="true"></input>
					                </div>										
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <input type="text" id="aliasDescripcion" name="aliasDescripcion" style="border-radius: 0px;"
									     class="form-control editField" readonly="true"></input>
					                </div>	
					            </div>
					            													            					            
                                <div class="row margin-reset" th:style="'display: ' + ${ordenamiento} + ';'"> 
                                    <br/>								
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Alias Imagen</p>
					                </div>								  
					                <div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Alias Dirección</p>
					                </div>								  
                                    <div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Mensaje Ordenamiento</p>									
					                </div>	
					            </div>
					            <div class="row margin-reset" th:style="'display: ' + ${ordenamiento} + ';'"> 
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <input type="text" id="aliasImagen" name="aliasImagen" style="border-radius: 0px;" 
									      class="form-control editField" readonly="true"></input>
					                </div>
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <input type="text" id="aliasDireccion" name="aliasDireccion" style="border-radius: 0px;" 
									      class="form-control editField" readonly="true"></input>
					                </div>
									<div class="col-xs-4 col-sm-4 col-md-4">
										<label class="lbl-select">
										    <select id="msgOrdenamiento" name="msgOrdenamiento" 
										     class="form-control" disabled="true">
										        <option value="false">No</option>
	                                            <option value="true">Si</option>                                            
	                                        </select> 
										</label>
					                </div>										
					            </div>							
							    <div id="estateIcons" class="row margin-reset" style="display: none;">
							    		<br/>	
								        <div class="col-xs-4 col-sm-4 col-md-4"> 
										    <p style="color:#9FC418;">Icono Aprobado</p>
			                                   <div class="file-loading">
			                                       <input id="iconoApr" name="iconoApr" type="file" class="iconoUpload editOtherField" disabled="disabled" onchange="cargarIcono(this.id)"></input>                                            
			                                   </div> 								
									    </div>					    						    
								        <div class="col-xs-4 col-sm-4 col-md-4"> 
										    <p style="color:#9FC418;">Icono Pendiente</p>
			                                   <div class="file-loading">
			                                       <input id="iconoPen" name="iconoPen" type="file" class="iconoUpload editOtherField" disabled="disabled" onchange="cargarIcono(this.id)"></input>                                            
			                                   </div> 								
									    </div>
								        <div class="col-xs-4 col-sm-4 col-md-4"> 
										    <p style="color:#9FC418;">Icono Rechazado</p>
			                                   <div class="file-loading">
			                                       <input id="iconoRec" name="iconoRec" type="file" class="iconoUpload editOtherField" disabled="disabled" onchange="cargarIcono(this.id)"></input>                                            
			                                   </div> 								
									    </div>			    
							    </div>
					        </div>
							<div class="col-xs-3 col-sm-3 col-md-3">
							    <div class="row margin-reset">
								    <p style="color:#9FC418;">Icono</p>
                                    <div class="file-loading">
                                       <input id="icono" name="icono" type="file" class="iconoUpload editOtherField" disabled="disabled" onchange="cargarIcono(this.id)"></input>                                           
                                    </div>						
							    </div>
							    <br/>
                                <div class="row margin-reset" th:style="'display: ' + ${noavistamiento} + ';'">
								    <p style="color:#9FC418;">Icono Marcador</p>	
                                    <div class="file-loading">
                                        <input id="iconoMar" name="iconoMar" type="file" class="iconoUpload editOtherField" disabled="disabled" onchange="cargarIcono(this.id)"></input>                                           
                                    </div>					
							    </div>	
                            </div>
					    </div>
					    <br/>
					    <p id="validacionEdicion" style="text-align:center; color: #FB0101"></p>
					    <p id="mensajeForm3" th:text="'' + ${mensajeFormulario3}" style="text-align:center"></p>
                        <input type="hidden" id="idAplicacionDeCapa" name="idAplicacionDeCapa" th:value="${idAplicacionDeCapa}"></input>
                        <input type="hidden" id="idCapaDeCategoria" name="idCapaDeCategoria" th:value="${idCapaDeCategoria}"></input>
                        <input type="hidden" id="nombreSelectOmitFromValidation" th:name="nombreSelectOmitFromValidation"></input>	
                        <input type="hidden" id="urlSelectOmitFromValidation" th:name="urlSelectOmitFromValidation"></input>					
                    </form> 
					

                    <form id="createCategoriaForm" th:action="@{/createUpdateCategoria}" th:method="post" onsubmit="return realizarValidacionesCreacion()" 
                     style="width:100%; background-color: #E8E8E8; float: center; font-size: 1.1vw; display: none;" enctype="multipart/form-data">  	         							  			
                       
					    <div class="row margin-reset"> 
                            <ul class="nav nav-tabs">
                                
                                <li data-toggle="tooltip" title="Guardar nueva categoría">
                                	<a style="padding:0px">
	                                    <button id="addNewCategoria" class="btn btn-action" type="submit">
	                                        <span class="glyphicon glyphicon-floppy-disk"></span>
	                                        <span class="btn-text"> Guardar</span>
	                                    </button>
                                    </a>
                                </li> 
                                
                                <li data-toggle="tooltip" title="Cancelar">
	                                <a style="padding:0px">
	                                    <button id="cancelNewCategoria" class="btn btn-action">
	                                        <span class="glyphicon glyphicon-remove"></span>
	                                        <span class="btn-text"> Cancelar</span>
	                                    </button>
	                                </a>
                                </li>
                                
                                <li data-toggle="tooltip" title="Deshacer">
								    <a id="botonDeshacerNew" style="padding:0px">
								     	 <div class="btn btn-action">
										     <span class="glyphicon glyphicon glyphicon-repeat"></span>
										     <span class="btn-text">Deshacer</span>
								     	 </div>
								    </a>
								</li>                                 
                                 
                            </ul> 						
					    </div>
					    
					    <br/>
						
						<div class="row margin-reset">  
						    <div class="col-xs-9 col-sm-9 col-md-9">
					   
					            <div class="row margin-reset"> 
									<div class="col-xs-2 col-sm-2 col-md-9">
									    <p style="color:#9FC418;">Nombre</p>
					                </div>
									<div class="col-xs-2 col-sm-2 col-md-3">
									    <p style="color: #9FC418;">Tipo</p>
								    </div>
					            </div>
                                <div class="row margin-reset">							
									<div class="col-xs-10 col-sm-10 col-md-9">
									    <input type="text" id="nombreNew" name="nombre" class="form-control" style="border-radius: 0px;"></input>
					                </div>					                					                														                					                
								    <div class="col-xs-4 col-sm-4 col-md-3">
									    <label class="lbl-select">
										    <select id="tipoNew" th:name="tipo" class="form-control">
	                                            <option th:each="tipo : ${tipoCapaList}" th:value="${tipo.id}" th:text="${tipo.nombre}"></option>
	                                        </select>										
										</label>									
								    </div>									
					            </div>	
					            
								<div class="row margin-reset"> 
						            <br/>								
									<div th:class="((${avistamiento} == 'block') ? 'col-xs-9 col-sm-9 col-md-9' : ((${ordenamiento} == 'block') ? 'col-xs-12 col-sm-12 col-md-12' : 'col-xs-12 col-sm-12 col-md-12')) + ';'">
									    <p style="color:#9FC418;">Descripción <span class="glyphicon glyphicon-pencil"></span> </p>
					                </div>	
									<div th:style="'display: ' + ${avistamiento} + ';'">
                                        <div class="col-xs-2 col-sm-2 col-md-3">
									        <p style="color:#9FC418;">Tiene Historia</p>									
					                    </div>
                                    </div>	
					            </div>
                                <div class="row margin-reset">                                 	
									<div th:class="((${avistamiento} == 'block') ? 'col-xs-9 col-sm-9 col-md-9' : ((${ordenamiento} == 'block') ? 'col-xs-12 col-sm-12 col-md-12' : 'col-xs-12 col-sm-12 col-md-12')) + ';'">
									    <input type="text" id="descripcionNew" name="descripcion" class="form-control" style="border-radius: 0px;"></input>
					                </div>									
									<div th:style="'display: ' + ${avistamiento} + ';'">
									    <div class="col-xs-2 col-sm-2 col-md-3">
										    <label class="lbl-select">
										        <select id="tieneHistoriaNew" name="tieneHistoria" class="form-control">
										            <option value="false">No</option>
	                                                <option value="true">Si</option>                                            
	                                            </select> 
										    </label>
					                    </div>
                                    </div>	
                                </div>
                                <div class="row margin-reset"> 
								    <div th:style="'display: ' + ${despliegueUrl} + ';'">
									    <br/>
									    <div class="col-xs-12 col-sm-12 col-md-12">
									        <p style="color:#9FC418;">URL Recurso</p>
					                    </div>
                                    </div>										
					            </div>	
                                <div class="row margin-reset"> 
								    <div th:style="'display: ' + ${despliegueUrl} + ';'">							  
									    <div class="col-xs-12 col-sm-12 col-md-12">
									        <input type="text" id="urlRecursoNew" name="urlRecurso" class="form-control" style="border-radius: 0px;"></input>
					                    </div>
                                    </div>										
					            </div>	
					            <div class="row margin-reset"> 
								    <div th:style="'display: ' + ${ordenamiento} + ';'">
									    <br/>
									    <div class="col-xs-4 col-sm-4 col-md-4">
									        <p style="color:#9FC418;">Polígono</p>									
					                    </div>	
                                        <div class="col-xs-4 col-sm-4 col-md-4">
									        <p style="color:#9FC418;">Ficha Caracterizacion</p>									
					                    </div>	
                                        <div class="col-xs-4 col-sm-4 col-md-4">
									        <p style="color:#9FC418;">Respuesta Ficha</p>
					                    </div>								  
								    </div>										
					            </div>																										           															                                
                                <div class="row margin-reset"> 
								    <div th:style="'display: ' + ${ordenamiento} + ';'">
									    <div class="col-xs-4 col-sm-4 col-md-4">
										    <label class="lbl-select">
										        <select id="poligonoNew" name="poligono" class="form-control">
	                                                <option value="false">No</option>
	                                                <option value="true">Si</option>                                            
	                                            </select> 
										    </label>
					                    </div>					                					                						                
									    <div class="col-xs-4 col-sm-4 col-md-4">
										    <label class="lbl-select">
										        <select id="fichaCaracterizacionNew" name="fichaCaracterizacion" 
										         class="form-control" disabled="true">
										            <option value="false">No</option>
	                                                <option value="true">Si</option>                                           
	                                            </select> 
										    </label>
					                    </div>	
									    <div class="col-xs-4 col-sm-4 col-md-4">
										    <label class="lbl-select">
										        <select id="respuestaFichaCaracNew" name="respuestaFichaCarac" 
										         class="form-control" disabled="true">
	                                                <option value=""></option>
	                                                <option value="SI/NO">SI/NO</option>                                            
	                                                <option value="NOMBRE">NOMBRE</option>
	                                                <option value="NOMBRE-DESCRIPCION">NOMBRE-DESCRIPCION</option>
	                                            </select> 
									   		</label>
					                    </div>	
									</div>						
					            </div>
                                <div class="row margin-reset" th:style="'display: ' + ${ordenamiento} + ';'"> 
								    <br/>
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Alias Nombre</p>
					                </div>								  
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Alias Municipio</p>
					                </div>								  
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Alias Descripción</p>
					                </div>								  
					            </div>
					            
                                <div class="row margin-reset" th:style="'display: ' + ${ordenamiento} + ';'"> 
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <input type="text" id="aliasNombreNew" name="aliasNombre" class="form-control" 
									     style="border-radius: 0px;"></input>
					                </div>	
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <input type="text" id="aliasMunicipioNew" name="aliasMunicipio" class="form-control" 
									     style="border-radius: 0px;"></input>
					                </div>										
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <input type="text" id="aliasDescripcionNew" name="aliasDescripcion" 
									     style="border-radius: 0px;" class="form-control"></input>
					                </div>								
					            </div>
					            
					            <div class="row margin-reset" th:style="'display: ' + ${ordenamiento} + ';'"> 
					            	<br/>
					                <div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Alias Imagen</p>
					                </div>
					                <div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Alias Dirección</p>
					                </div>
                                    <div class="col-xs-4 col-sm-4 col-md-4">
									    <p style="color:#9FC418;">Mensaje Ordenamiento</p>									
					                </div>									
					            </div>
					            <div class="row margin-reset" th:style="'display: ' + ${ordenamiento} + ';'">
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <input type="text" id="aliasImagenNew" name="aliasImagen" 
									     style="border-radius: 0px;" class="form-control"></input>
					                </div>							  
									<div class="col-xs-4 col-sm-4 col-md-4">
									    <input type="text" id="aliasDireccionNew" name="aliasDireccion" 
									     style="border-radius: 0px;" class="form-control"></input>
					                </div>
									<div class="col-xs-4 col-sm-4 col-md-4">
										<label class="lbl-select">
										    <select id="msgOrdenamientoNew" name="msgOrdenamiento" 
										     class="form-control" disabled="true">
										        <option value="false">No</option>
	                                            <option value="true">Si</option>                                            
	                                        </select> 
										</label>
					                </div>										
					            </div>
							    <div id="estateIconsNew" class="row margin-reset" style="display: none;">
							    	<br/>	
								    <div class="col-xs-4 col-sm-4 col-md-4">						    						    
									    <p style="color:#9FC418;">Icono Aprobado</p>																
		                                <div class="file-loading">
		                                    <input id="iconoAprNew" name="iconoApr" type="file" class="iconoUpload"></input>                                            
		                                </div> 								
								    </div>							    
								    <div class="col-xs-4 col-sm-4 col-md-4">						    						    
									    <p style="color:#9FC418;">Icono Pendiente</p>																
		                                <div class="file-loading">
		                                    <input id="iconoPenNew" name="iconoPen" type="file" class="iconoUpload"></input>                                            
		                                </div> 								
								    </div>						    
								    <div class="col-xs-4 col-sm-4 col-md-4">						    						    
									    <p style="color:#9FC418;">Icono Rechazado</p>																
		                                <div class="file-loading">
		                                    <input id="iconoRecNew" name="iconoRec" type="file" class="iconoUpload"></input>                                            
		                                </div> 								
								    </div>					    
							    </div>
                            </div>
							<div class="col-xs-3 col-sm-3 col-md-3">
							    <div class="row margin-reset"> 
								    <p style="color:#9FC418;">Icono</p>	
                                    <div class="file-loading">
                                       <input id="iconoNew" name="icono" type="file" class="iconoUpload"></input>                                           
                                    </div> 	
							    </div>
							    <br/>
                                <div class="row margin-reset" th:style="'display: ' + ${noavistamiento} + ';'"> 
								    <p style="color:#9FC418;">Icono Marcador</p>									
                                    <div class="file-loading">
                                       <input id="iconoMarNew" name="iconoMar" type="file" class="iconoUpload"></input>                                           
                                    </div> 	
							    </div>
                            </div>
					    </div>
					    <br/>
					    <p id="validacionCreacion" style="text-align:center; color: #FB0101"></p>
                        <input type="hidden" id="idAplicacionDeCapa" name="idAplicacionDeCapa" th:value="${idAplicacionDeCapa}"></input>
                        <input type="hidden" id="idCapaDeCategoria" name="idCapaDeCategoria" th:value="${idCapaDeCategoria}"></input>						
                    </form> 

                    <h4 id="rutaMostrada" style="color:#FFFFFF;" th:text="${rutaMostrada}"></h4> 
					
                    <br/>
                          
                    <h2 style="text-align:left; color: #FFFFFF;">Categorías</h2>
      	        	 
      	        	<div style="overflow-x:auto;"> 
               	    <table id="tableCategorias" class="table table-striped table-bordered" cellspacing="0" 
               	           style="width: 100%; background-color: #E8E8E8; font-size: 0.9vw;">
               	        <thead>
               	            <tr>                                   
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Descripción</th>
                                <th>Tipo Categoría</th>
                                <th style="text-align: center;">Icono</th> 
                                <th style="text-align: center;">Icono Marcador</th> 
                                <th th:style="'display: ' + ${avistamiento} + ';text-align: center;'">Especies</th>
                                <th style="text-align: center;">Eliminar</th>
                                <th style="text-align: center;">Editar</th>                                               
                            </tr>
                        </thead>
                          
                        <tbody>                   
                            <tr th:each="categoria : ${categoriaList}">
                                <td th:text="${categoria.id}"></td>
                                <td th:text="${categoria.nombre}"></td>
                                <td th:text="${categoria.descripcion}"></td>
                                <td th:text="${categoria.tipoCategoria.nombre}"></td>
                                <td align="center">
                                  <img th:src="${categoria.icono.rutaLogo}" style="width: 40px; top: -9px;"/>
                                </td>    
                                <td align="center">
                                    <img th:src="${categoria.iconoMarcador.rutaLogo}" 
                                     th:style="'display: ' + ${noavistamiento} + '; width: 40px; top: -9px;'"/>
                                    
                                    <table th:style="'display: ' + ${avistamiento} + '; font-size: 0.6vw;'"
                                           th:if="(${categoria.tipoCategoria.id} == 2) OR (${categoria.tipoCategoria.id} == 5) OR
									              (${categoria.tipoCategoria.id} == 8)">
								        <thead>
               	                            <tr>                                   
                                               <th>Aprobado</th>
                                               <th>Pendiente</th>
                                               <th>Rechazado</th>							
                                            </tr>
                                        </thead>
                                        <tbody>                   
                                            <tr>
                                                <td><img th:src="${categoria.rutaIconoAprobado}" style="width: 40px; top: -9px;"/></td>
                                                <td><img th:src="${categoria.rutaIconoPendiente}" style="width: 40px; top: -9px;"/></td>
                                                <td><img th:src="${categoria.rutaIconoRechazado}" style="width: 40px; top: -9px;"/></td>
                                            </tr>
                                        </tbody>  
								    </table> 
                                </td>                                  
                                <td th:style="'display: ' + ${avistamiento} + ';'">
									<a class="btn btn-default"
									 th:style="'height:32px; background-color: #9FC418; 
									 border: 1px solid; border-color: #D0D0D0; border-radius: 3px; font-size: 0.9vw;'"
									 th:if="(${categoria.tipoCategoria.id} == 2) OR (${categoria.tipoCategoria.id} == 5) OR
									        (${categoria.tipoCategoria.id} == 8)" 									
								     th:href="'/getEspeciesByIdCategoria/' + ${idAplicacionDeCapa} + '/'
								                                           + ${idCapaDeCategoria} + '/' + ${categoria.id}">
								         <span style="color: #FFFFFF;">Especies</span>
								    </a>
								</td>                                
                                <td align="center">
									<a th:id="${categoria.id}" class="btn btn-default deleteButton" th:if="${puedeBorrar}" 
									 style="height:32px; background-color: #FB0101; border: 1px solid; border-color: #D0D0D0; border-radius: 3px;"> 								     
								        <span style="color: #FFFFFF;" class="glyphicon glyphicon-trash"></span> 
								    </a>
								</td>                        
                                <td align="center">
                                    <button th:id="${categoria.id}" style="background-color: #9FC418;" 
                                     th:if="${puedeEditar}" class="btn btn-default editButton">
									    <span style="color: #FFFFFF;" class="glyphicon glyphicon-pencil"></span>
									</button>
                                </td>                           
                            </tr>                                                                                                     
                        </tbody>
                    </table>
                    </div>  
						
                </div>
               
            </div>       
        </div>  
                         				
    </section>
    
    <div th:replace="fragments/printMap :: printMap"></div>      
	
    <script th:inline="javascript">
	    $(document).ready(function() {
		    $('#tableCategorias').DataTable({
	             "language": {"url": "/assets/json/spanishTable.json"},
	                "columnDefs": [
	                	{"targets": [2], "className" : "cell-desc" },
	                	{"targets": [4,5,6,7,8], "orderable" : false}
	                ]
	         });
	    }); 
    
        function openModalCategorias() {
            document.getElementById('modalCategorias').style.display = "block";
        }  
    
        function closeModalCategorias() {
            document.getElementById('modalCategorias').style.display = "none";
        }
        
        $('.editButton').on('click', function() {
            var id = $(this).attr('id');
            llenarFormularioEdicionCategorias(id);
        });
            
        function llenarFormularioEdicionCategorias(id) {           
            $.ajax({
                url: "/getCategoria/" + id,
                method: "GET",
            }).success(function(response) {            	
            	$('#validacionEdicion').text("  ");   
            	$('#validacionCreacion').text("  ");            	
            	$('#mensajeForm3').text("  ");
            	
                $('#editCategoriaForm')
                    .find('[name="id"]').val(response.id).end()
                    .find('[name="nombre"]').val(response.nombre).end()
                    .find('[name="nombreSelectOmitFromValidation"]').val(""+response.nombre).end() 
                    .find('[name="urlSelectOmitFromValidation"]').val(""+response.urlRecurso).end() 
                    .find('[name="descripcion"]').val(response.descripcion).end() 
                    .find('[name="tipo"]').val(""+response.tipoCategoria.id).end()
                    .find('[name="urlRecurso"]').val(response.urlRecurso).end()
                    .find('[name="aliasNombre"]').val(response.aliasNombre).end()                       
                    .find('[name="aliasMunicipio"]').val(response.aliasMunicipio).end()
                    .find('[name="aliasDescripcion"]').val(response.aliasDescripcion).end()  
                    .find('[name="aliasImagen"]').val(response.aliasImagen).end()  
                    .find('[name="aliasDireccion"]').val(response.aliasDireccion).end()
                    .find('[name="fichaCaracterizacion"]').val(""+response.fichaCaracterizacion).end()
                    .find('[name="respuestaFichaCarac"]').val(""+response.respuestaFichaCarac).end()
                    .find('[name="poligono"]').val(""+response.poligono).end()
                    .find('[name="tieneHistoria"]').val(""+response.tieneHistoria).end()
                    .find('[name="msgOrdenamiento"]').val(""+response.msgOrdenamiento).end();
                
                if((response.tipoCategoria.id == 5) || 
                   (response.tipoCategoria.id == 8)){
                	$('#estateIcons').show();
                }else{
                	$('#estateIcons').hide();
                }
                
                $('.editField').attr("readonly",false);
                $('#botonEdicion').css("display","block");
                $('#botonDeshacerEdit').css("display","block");
                $('.editOtherField').attr("disabled",false);
                $('.iconoUploadStyle').css("cursor","pointer");
                
                if (response.icono != null){
	               	visualizarImagen("icono",response.icono.rutaLogo);
                }else{
                	visualizarImagen("icono",null);
                }
               	if (response.iconoMarcador != null){
	               	visualizarImagen("iconoMar",response.iconoMarcador.rutaLogo);
               	}else{
               		visualizarImagen("iconoMar",null);
               	}
               	visualizarImagen("iconoApr",response.rutaIconoAprobado);
               	visualizarImagen("iconoRec",response.rutaIconoRechazado);
               	visualizarImagen("iconoPen",response.rutaIconoPendiente);
                
				var despliegueUrl = "" + [[${despliegueUrl}]] + "";
				
				if(despliegueUrl=="block"){                  
                    $('#modalProgramCateg').find('#programTaskCategForm').find('[name="id"]').val(response.id);
                    $('#modalProgramCateg').find('#programTaskCategForm').find('[name="nombre"]').val(response.nombre);
                    $('#modalProgramCateg').find('#programTaskCategForm').find('[name="urlRecurso"]').val(response.urlRecurso);
                    
                    var linkRun = "/runTaskCateg/" + [[${idAplicacionDeCapa}]] + "/" + [[${idCapaDeCategoria}]] + "/" + id
            	    $('#runTaskButton').attr("href",linkRun);
                    
                    var linkStop = "/stopTaskCateg/" + [[${idAplicacionDeCapa}]] + "/" + [[${idCapaDeCategoria}]] + "/" + id
            	    $('#stopTaskButton').attr("href",linkStop);
                    
                    $.ajax({
                        url: "/mostrarBotonesURL/CATEGORIA/" + id,
                        method: "GET",
                    }).success(function(response) {                	
                    	if(response=="ninguno"){
                    		$('#stopTaskButtons').hide();
                    		$('#programButtons').hide();
                    		$('#div-urlRecurso').removeClass("col-xs-9 col-sm-9 col-md-9");
                    		$('#div-urlRecurso').addClass("col-xs-12 col-sm-12 col-md-12");
                    	} 
                    	if(response=="ejecutar"){
                    		$('#stopTaskButtons').hide();
                    		$('#programButtons').show();
                    		$('#div-urlRecurso').removeClass("col-xs-12 col-sm-12 col-md-12");
                    		$('#div-urlRecurso').addClass("col-xs-9 col-sm-9 col-md-9");
                    	} 
                    	if(response=="detener"){
                    		$('#stopTaskButtons').show();
                    		$('#programButtons').hide();
                    		$('#div-urlRecurso').removeClass("col-xs-12 col-sm-12 col-md-12");
                    		$('#div-urlRecurso').addClass("col-xs-9 col-sm-9 col-md-9");
                    	}
                    }); 
                }								
            });                               
        };  
    
        $('#showFormNewCategoria').on('click', function() {
        	document.getElementById("editCategoriaForm").reset();
            $('#editCategoriaForm').hide();              
            $('#createCategoriaForm').show(); 
            $('#validacionCreacion').text("  ");
            $('#mensajeForm3').text("  ");
        }); 
    
        $('#cancelNewCategoria').on('click', function() {
            $('#editCategoriaForm').show(); 
            document.getElementById("createCategoriaForm").reset();
            $('.editField').attr("readonly",true);
            $('#botonEdicion').css("display","none");
            $('#botonDeshacerEdit').css("display","none");
            $('#createCategoriaForm').hide();             
            $('#validacionEdicion').text("  ");
            $('#mensajeForm3').text("  "); 
        });      
        
        $('#botonDeshacerEdit').on('click', function() {
            var id = $("#id").val(); 
			llenarFormularioEdicionCategorias(id); 
        });


        $('#botonDeshacerNew').on('click', function() {
            document.getElementById("createCategoriaForm").reset();
            $('#validacionCreacion').text("  ");
        });
    
        $(document).on('ready', function() {
            $(".iconoUpload").fileinput({
                browseClass: "btn-sm btn-block iconoUploadStyle",
                showCaption: false,
                showRemove: false,
                showUpload: false,
                allowedFileExtensions: ["jpg","png","svg"],
                browseLabel: 'Seleccionar'
            });
        });
              
        $('#poligono').change(function() {
            var poligonoValor = $(this).val();      
            if(poligonoValor=="false"){
            	$('#fichaCaracterizacion').attr("disabled",true);
            	$('#fichaCaracterizacion').attr("value",false);   
            	$('#msgOrdenamiento').attr("disabled",true);
            	$('#msgOrdenamiento').attr("value",false); 
            	$('#respuestaFichaCarac').attr("disabled",true);
            	$('#respuestaFichaCarac').attr("value",""); 
            }else{
            	$('#fichaCaracterizacion').attr("disabled",false);
            	$('#msgOrdenamiento').attr("disabled",false);
            }
        });
        
        $('#poligonoNew').change(function() {
            var poligonoValor = $(this).val();      
            if(poligonoValor=="false"){
            	$('#fichaCaracterizacionNew').attr("disabled",true);
            	$('#fichaCaracterizacionNew').attr("value",false);   
            	$('#msgOrdenamientoNew').attr("disabled",true);
            	$('#msgOrdenamientoNew').attr("value",false); 
            	$('#respuestaFichaCaracNew').attr("disabled",true);
            	$('#respuestaFichaCaracNew').attr("value",""); 
            }else{
            	$('#fichaCaracterizacionNew').attr("disabled",false);
            	$('#msgOrdenamientoNew').attr("disabled",false);
            }
        });    
        
        $('#fichaCaracterizacion').change(function() {
            var fichaCaracValor = $(this).val();      
            if(fichaCaracValor=="false"){
            	$('#respuestaFichaCarac').attr("disabled",true);
            	$('#respuestaFichaCarac').attr("value",""); 
            }else{
            	$('#respuestaFichaCarac').attr("disabled",false);
            }
        });        
        
        $('#fichaCaracterizacionNew').change(function() {
            var fichaCaracValor = $(this).val();      
            if(fichaCaracValor=="false"){
            	$('#respuestaFichaCaracNew').attr("disabled",true);
            	$('#respuestaFichaCaracNew').attr("value",""); 
            }else{
            	$('#respuestaFichaCaracNew').attr("disabled",false);
            }
        });        
        
        $('#tipo').change(function() {
            var idTipoCapa = $(this).attr('value');      
            if((idTipoCapa == 5) || (idTipoCapa == 8)){
            	$('#estateIcons').show();
            }else{
            	$('#estateIcons').hide();
            }
        });
        
        $('#tipoNew').change(function() {
            var idTipoCapa = $(this).attr('value');      
            if((idTipoCapa == 5) || (idTipoCapa == 8)){
            	$('#estateIconsNew').show();
            }else{
            	$('#estateIconsNew').hide();
            }
        });
    </script> 
    

    <script th:inline="javascript">
        $('.deleteButton').on('click', function() {
        	var id = $(this).attr('id'); 
        	var linkDelete = "/deleteCategoria/" + [[${idAplicacionDeCapa}]] + "/" + [[${idCapaDeCategoria}]] + "/" + id
        	$('#confirmDelete').attr("href",linkDelete);        	
        	$('#modalConfirmDelete').show();        	
        	$('#modalConfirmDelete').find('#cancelDelete').on('click', function() {
                $('#modalConfirmDelete').hide();
            });        	
        	$('#modalConfirmDelete').find('#confirmDelete').on('click', function() {
                $('#modalConfirmDelete').hide();
            });
        });  
    </script>
    
    <div th:replace="fragments/dialog :: modalConfirmDelete"></div> 

    
    
    <script th:inline="javascript">
        $('.programTaskCateg').on('click', function() {        	
        	$('#modalProgramCateg').show();        	
        	$('#modalProgramCateg').find('#cancelarProgram').on('click', function() {
                $('#modalProgramCateg').hide();
            });        	
        	$('#modalProgramCateg').find('#programTask').on('click', function() {
                $('#modalProgramCateg').hide();
            });
        });  
    </script>
    
    <div th:replace="fragments/dialog :: modalProgramCateg"></div> 



    <script type="text/javascript" th:inline="javascript" >	
        /*<![CDATA[*/
        function realizarValidacionesEdicion(){ 
        	
        	var descripcion = $("#descripcion").val();             
            if(descripcion != null){ 	
        	    if(descripcion == ""){ 
        	        document.getElementById('validacionEdicion').innerHTML = "La Descripción está vacía";
                    return false;
        	    }else{
        	    	if(descripcion.length > 255){
                		document.getElementById('validacionEdicion').innerHTML = "La descripción no puede tener más de 255 caracteres";
                        return false;
                	}
        	    }
        	}	
            
            var nombre = $("#nombre").val(); 
            var nombreSelectOmitFromValidation = $("#nombreSelectOmitFromValidation").val(); 
            if(nombre != null){
                if(nombre == ""){ 
                	document.getElementById('validacionEdicion').innerHTML = "El Nombre está vacío";
                    return false;
                }else{
                	if(nombre.length > 30){
                		document.getElementById('validacionEdicion').innerHTML = "El nombre no puede tener más de 30 caracteres";
                        return false;
                	}
                	
                    var nombresList = [[${nombresList}]];
                	for(i = 0; i < nombresList.length; i++){
                		if(nombresList[i]!=nombreSelectOmitFromValidation){
                			if(nombresList[i]==nombre){
                			    document.getElementById('validacionEdicion').innerHTML = "Este Nombre ya está en uso";
                        	    return false; 	
                			}
                		}
                	}   	
                } 
            }	
            
            var url = $("#urlRecurso").val(); 
            var urlSelectOmitFromValidation = $("#urlSelectOmitFromValidation").val(); 
            if(url != null){
            	var urlsList = [[${urlsList}]];
            	for(i = 0; i < urlsList.length; i++){
            		if(urlsList[i]!=urlSelectOmitFromValidation){
            			if(urlsList[i]==url){
            				document.getElementById('validacionEdicion').innerHTML = "Esta Url ya está en uso";
            				return false; 	
                		}
                	}
                }   	
            }            
        };
               
        function realizarValidacionesCreacion(){ 
        	
        	var descripcion = $("#descripcionNew").val(); 
            if(descripcion != null){ 
        	    if(descripcion == ""){ 
        	    	document.getElementById('validacionCreacion').innerHTML = "La Descripción está vacía";
                    return false;
        	    }else{
        	    	if(descripcion.length > 255){
                		document.getElementById('validacionCreacion').innerHTML = "La descripción no puede tener más de 255 caracteres";
                        return false;
                	}
        	    }
        	}	
        	
            var nombre = $("#nombreNew").val(); 
            if(nombre != null){
                if(nombre == ""){ 
                	document.getElementById('validacionCreacion').innerHTML = "El Nombre está vacío";
                    return false;
                }else{  
                	if(nombre.length > 30){               		
                		document.getElementById('validacionCreacion').innerHTML = "El nombre no puede tener más de 30 caracteres";
                        return false;
                	}
                	
                    var nombresList = [[${nombresList}]];
                	for(i = 0; i < nombresList.length; i++){
                	    if(nombresList[i]==nombre){
                		    document.getElementById('validacionCreacion').innerHTML = "Este Nombre ya está en uso";
                        	return false; 	
                		}        			
                	}
                } 
            }
            
            var url = $("#urlRecursoNew").val(); 
            if(url != null){
            	var urlsList = [[${urlsList}]];
            	for(i = 0; i < urlsList.length; i++){
            		if(urlsList[i]==url){
            			document.getElementById('validacionCreacion').innerHTML = "Esta Url ya está en uso";
                        return false; 	
                	}        			
                }
            }             
            
            var icono = $("#iconoNew").val();     
            if(icono != null){ 
            	if(icono == ""){ 
        	        document.getElementById('validacionCreacion').innerHTML = "Debe cargar un icono";
                    return false;
            	}
        	}
            
            var idTipo = $("#tipoNew").val();      
            if((idTipo == 5) || (idTipo == 8)){
            	var iconoApr = $("#iconoAprNew").val(); 
            	if(iconoApr == ""){ 
        	        document.getElementById('validacionCreacion').innerHTML = "Debe cargar un icono para el estado Aprobado";
                    return false;
            	}else{
            		var iconoPen = $("#iconoPenNew").val(); 
            		if(iconoPen == ""){ 
            	        document.getElementById('validacionCreacion').innerHTML = "Debe cargar un icono para el estado Pendiente";
                        return false;
                	}else{
                		var iconoRec = $("#iconoRecNew").val(); 
                		if(iconoRec == ""){ 
                	        document.getElementById('validacionCreacion').innerHTML = "Debe cargar un icono para el estado Rechazado";
                            return false;
                    	}
                	}
            	}        	    
            }
            
        };
        /*]]>*/
    </script> 
   	                 	  
</body>

    
</html>
